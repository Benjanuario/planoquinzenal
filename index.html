<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Gerador de Plano Quinzenal</title>
<style>
body { font-family: "Times New Roman", Times, serif; font-size: 12pt; padding: 20px; background-color: #f9f9f9;}
h1 { text-align:center; color:#333;}
form { max-width:700px; margin:0 auto; background:#fff; padding:20px; border-radius:8px; box-shadow:0 0 10px rgba(0,0,0,0.1);}
label { display:block; margin-top:15px; font-weight:bold;}
select, input { width:100%; padding:8px; margin-top:5px; border-radius:4px; border:1px solid #ccc; font-size:12pt;}
button { margin-top:20px; padding:10px 20px; background:#007BFF; color:#fff; font-size:12pt; border:none; border-radius:6px; cursor:pointer;}
button:hover { background:#0056b3;}
#resultado { margin-top: 30px; background:#fff; padding:20px; border-radius:8px; box-shadow:0 0 10px rgba(0,0,0,0.1); display:none; }
pre { white-space: pre-wrap; word-wrap: break-word; }
</style>
</head>
<body>
<h1>Gerador de Plano Quinzenal</h1>
<form id="formPlanoQuinzenal">
  <label>Classe:</label>
  <select id="classe"></select>
  <label>Disciplina:</label>
  <select id="disciplina"></select>
  <label>Trimestre:</label>
  <select id="trimestre">
    <option value="1Âº Trimestre">1Âº Trimestre</option>
    <option value="2Âº Trimestre">2Âº Trimestre</option>
    <option value="3Âº Trimestre">3Âº Trimestre</option>
  </select>
  <label>Semana de:</label>
  <select id="semanaDe"></select>
  <label>Semana atÃ©:</label>
  <select id="semanaAte"></select>
  <button type="button" onclick="gerarPlano()">Gerar Plano Quinzenal</button>
</form>

<div id="resultado"><pre id="planoConteudo"></pre></div>

<script>
// ğŸ”— URL do seu Apps Script
const API_URL = "https://script.google.com/macros/s/AKfycbzr6uPcJzqZZfebnaaKFejIvazcxAH65uKWDlBpnU8wH6Pm-iITj-zRDE7bwinkEedp/exec";

const disciplinasPorClasse = {
  "1Âª Classe":["PortuguÃªs","MatemÃ¡tica","EducaÃ§Ã£o FÃ­sica"],
  "2Âª Classe":["PortuguÃªs","MatemÃ¡tica","EducaÃ§Ã£o FÃ­sica"],
  "3Âª Classe":["PortuguÃªs","MatemÃ¡tica","EducaÃ§Ã£o FÃ­sica"],
  "4Âª Classe":["PortuguÃªs","MatemÃ¡tica","CiÃªncias Naturais","CiÃªncias Sociais","EducaÃ§Ã£o FÃ­sica"],
  "5Âª Classe":["PortuguÃªs","MatemÃ¡tica","CiÃªncias Naturais","CiÃªncias Sociais","EducaÃ§Ã£o Visual e OfÃ­cios","EducaÃ§Ã£o FÃ­sica"],
  "6Âª Classe":["PortuguÃªs","MatemÃ¡tica","CiÃªncias Naturais","CiÃªncias Sociais","EducaÃ§Ã£o Visual e OfÃ­cios","EducaÃ§Ã£o FÃ­sica"],
  "7Âª Classe":["PortuguÃªs","MatemÃ¡tica","Biologia","QuÃ­mica","FÃ­sica","Geografia","HistÃ³ria","TIC","InglÃªs","EducaÃ§Ã£o Visual","EducaÃ§Ã£o FÃ­sica"],
  "8Âª Classe":["PortuguÃªs","MatemÃ¡tica","Biologia","QuÃ­mica","FÃ­sica","Geografia","HistÃ³ria","TIC","InglÃªs","EducaÃ§Ã£o Visual","EducaÃ§Ã£o FÃ­sica"],
  "9Âª Classe":["PortuguÃªs","MatemÃ¡tica","Biologia","QuÃ­mica","FÃ­sica","Geografia","HistÃ³ria","TIC","InglÃªs","EducaÃ§Ã£o Visual","EducaÃ§Ã£o FÃ­sica"],
  "10Âª Classe":["PortuguÃªs","MatemÃ¡tica","Biologia","QuÃ­mica","FÃ­sica","Geografia","HistÃ³ria","TIC","InglÃªs","FrancÃªs","NoÃ§Ãµes de Empreendedorismo","EducaÃ§Ã£o Visual","EducaÃ§Ã£o FÃ­sica"],
  "11Âª Classe":["PortuguÃªs","MatemÃ¡tica","Biologia","QuÃ­mica","FÃ­sica","Geografia","HistÃ³ria","TIC","InglÃªs","FrancÃªs","Filosofia","NoÃ§Ãµes de Empreendedorismo","EVT","DGD","EducaÃ§Ã£o FÃ­sica"],
  "12Âª Classe":["PortuguÃªs","MatemÃ¡tica","Biologia","QuÃ­mica","FÃ­sica","Geografia","HistÃ³ria","TIC","InglÃªs","FrancÃªs","Filosofia","NoÃ§Ãµes de Empreendedorismo","EVT","DGD","EducaÃ§Ã£o FÃ­sica"]
};

function preencherSemanas(selectId) {
  const select = document.getElementById(selectId);
  select.innerHTML = '';
  for (let i = 1; i <= 13; i++) {
    const opt = document.createElement('option');
    opt.value = i;
    opt.textContent = `${i}Âª Semana`;
    select.appendChild(opt);
  }
}

function atualizarDisciplinas() {
  const classeSelect = document.getElementById('classe');
  const disciplinaSelect = document.getElementById('disciplina');
  const disciplinas = disciplinasPorClasse[classeSelect.value] || [];
  disciplinaSelect.innerHTML = '';
  disciplinas.forEach(d => {
    const option = document.createElement('option');
    option.value = d;
    option.textContent = d;
    disciplinaSelect.appendChild(option);
  });
}

window.addEventListener('DOMContentLoaded', () => {
  const classeSelect = document.getElementById('classe');
  Object.keys(disciplinasPorClasse).forEach(classe => {
    const option = document.createElement('option');
    option.value = classe;
    option.textContent = classe;
    classeSelect.appendChild(option);
  });
  atualizarDisciplinas();
  preencherSemanas('semanaDe');
  preencherSemanas('semanaAte');
});

async function gerarPlano() {
  const classe = document.getElementById('classe').value;
  const disciplina = document.getElementById('disciplina').value;
  const trimestre = document.getElementById('trimestre').value;
  const semanaDe = parseInt(document.getElementById('semanaDe').value);
  const semanaAte = parseInt(document.getElementById('semanaAte').value);

  if (!classe || !disciplina || !trimestre) {
    alert("Selecione Classe, Disciplina e Trimestre.");
    return;
  }

  if (semanaDe > semanaAte) {
    alert("A semana inicial nÃ£o pode ser maior que a final.");
    return;
  }

  if (semanaAte - semanaDe > 2) {
    alert("O intervalo nÃ£o pode exceder 3 semanas (ex: 1 a 3).");
    return;
  }

  try {
    const url = `${API_URL}?classe=${encodeURIComponent(classe)}&disciplina=${encodeURIComponent(disciplina)}&trimestre=${encodeURIComponent(trimestre)}&semanaDe=${semanaDe}&semanaAte=${semanaAte}`;
    const res = await fetch(url);
    const planos = await res.json();

    let plano = "";
    planos.forEach(p => {
      plano += `Semana ${p.numero}\n`;
      plano += `Unidade TemÃ¡tica: ${p.unidade_tematica || ""}\n`;
      plano += `Objetivos: ${p.objetivo_especifico || ""}\n`;
      plano += `ConteÃºdos: ${p.conteudo || ""}\n`;
      plano += `CompetÃªncias: ${p.competencia_basica || ""}\n`;
      plano += `Carga HorÃ¡ria: ${p.carga_horaria || ""}\n\n`;  // â† Nova coluna
    });

    const resultadoDiv = document.getElementById("resultado");
    const conteudoEl = document.getElementById("planoConteudo");
    if (plano) {
      conteudoEl.textContent = plano;
    } else {
      conteudoEl.textContent = "Nenhum plano encontrado para o perÃ­odo selecionado.";
    }
    resultadoDiv.style.display = "block";
  } catch (e) {
    console.error(e);
    alert("Erro ao carregar plano: " + e.message);
  }
}
</script>
</body>
</html>