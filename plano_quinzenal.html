<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Plano Quinzenal</title>
<style>
  body { font-family: Arial, sans-serif; padding: 20px; }
  table { border-collapse: collapse; width: 100%; margin-top: 15px; }
  th, td { border: 1px solid #000; padding: 8px; vertical-align: top; }
  th { background-color: #f0f0f0; }
  ul { padding-left: 20px; margin: 0; }
</style>
</head>
<body onload="mostrarPlano()">
<h1>Plano Quinzenal</h1>
<div id="plano"></div>

<script>
function formatarLista(texto) {
  if(!texto) return '';
  // Divide por linha ou por "•", remove itens vazios e espaços
  const itens = texto.split(/[\n•]+/).map(i => i.trim()).filter(i => i.length > 0);
  if(itens.length === 0) return '';
  return '<ul><li>' + itens.join('</li><li>') + '</li></ul>';
}

function mostrarPlano() {
  const plano = JSON.parse(localStorage.getItem("planoQuinzenal"));
  if(!plano || !plano.dados.length) {
    document.getElementById("plano").innerText = "Nenhum dado encontrado.";
    return;
  }

  let html = `<h2>${plano.disciplina} — ${plano.classe}</h2>
              <p>${plano.trimestre}</p>
              <p>Semanas: ${plano.semanaDe}ª à ${plano.semanaAte}ª</p>
              <table>
                <tr>
                  <th>Semana</th>
                  <th>Objetivo Específico</th>
                  <th>Conteúdo</th>
                  <th>Competência Básica</th>
                  <th>Carga Horária</th>
                </tr>`;

  plano.dados.forEach(semana => {
    html += `<tr>
      <td>${semana.numero}ª</td>
      <td>${formatarLista(semana.objetivo_especifico)}</td>
      <td>${formatarLista(semana.conteudo)}</td>
      <td>${formatarLista(semana.competencia_basica)}</td>
      <td>${semana.carga_horaria}</td>
    </tr>`;
  });

  html += "</table>";
  document.getElementById("plano").innerHTML = html;
}
</script>
</body>
</html>