<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Gerador de Plano Quinzenal</title>
<style>
body { font-family: "Times New Roman", Times, serif; font-size: 12pt; padding: 20px; background-color: #f9f9f9; }
h1 { text-align:center; color:#333; }
form { max-width:700px; margin:0 auto; background:#fff; padding:20px; border-radius:8px; box-shadow:0 0 10px rgba(0,0,0,0.1); }
label { display:block; margin-top:15px; font-weight:bold; }
select, input { width:100%; padding:8px; margin-top:5px; border-radius:4px; border:1px solid #ccc; font-size:12pt; }
button { margin-top:20px; padding:10px 20px; background:#007BFF; color:#fff; font-size:12pt; border:none; border-radius:6px; cursor:pointer; }
button:hover { background:#0056b3; }
#resultado { margin-top: 30px; background:#fff; padding:20px; border-radius:8px; box-shadow:0 0 10px rgba(0,0,0,0.1); display:none; }
pre { white-space: pre-wrap; word-wrap: break-word; }
</style>
</head>
<body>
<h1>Gerador de Plano Quinzenal</h1>

<form id="formPlanoQuinzenal">
  <label>Classe:</label>
  <select id="classe"></select>
  <label>Disciplina:</label>
  <select id="disciplina"></select>
  <label>Trimestre:</label>
  <select id="trimestre">
    <option value="1º Trimestre">1º Trimestre</option>
    <option value="2º Trimestre">2º Trimestre</option>
    <option value="3º Trimestre">3º Trimestre</option>
  </select>
  <label>Semana de:</label>
  <select id="semanaDe"></select>
  <label>Semana até:</label>
  <select id="semanaAte"></select>
  <button type="button" onclick="gerarPlano()">Gerar Plano Quinzenal</button>
</form>

<div id="resultado"><pre id="planoConteudo"></pre></div>

<script>
const API_URL = "AKfycbzwUIx0Kuqr_Px1WOG5_uI0q3_pbeYSJXHjJnEO18OlZLQ7FkfUCFESBgGMihrl2bteZw/exec"; // substitui aqui também

const disciplinasPorClasse = {
  "1ª Classe":["Português","Matemática","Educação Física"],
  "2ª Classe":["Português","Matemática","Educação Física"],
  "3ª Classe":["Português","Matemática","Educação Física"],
  "4ª Classe":["Português","Matemática","Ciências Naturais","Ciências Sociais","Educação Física"],
  "5ª Classe":["Português","Matemática","Ciências Naturais","Ciências Sociais","Educação Visual e Ofícios","Educação Física"],
  "6ª Classe":["Português","Matemática","Ciências Naturais","Ciências Sociais","Educação Visual e Ofícios","Educação Física"],
  "7ª Classe":["Português","Matemática","Biologia","Química","Física","Geografia","História","TIC","Inglês","Educação Visual","Educação Física"],
  "8ª Classe":["Português","Matemática","Biologia","Química","Física","Geografia","História","TIC","Inglês","Educação Visual","Educação Física"],
  "9ª Classe":["Português","Matemática","Biologia","Química","Física","Geografia","História","TIC","Inglês","Educação Visual","Educação Física"],
  "10ª Classe":["Português","Matemática","Biologia","Química","Física","Geografia","História","TIC","Inglês","Francês","Noções de Empreendedorismo","Educação Visual","Educação Física"],
  "11ª Classe":["Português","Matemática","Biologia","Química","Física","Geografia","História","TIC","Inglês","Francês","Filosofia","Noções de Empreendedorismo","EVT","DGD","Educação Física"],
  "12ª Classe":["Português","Matemática","Biologia","Química","Física","Geografia","História","TIC","Inglês","Francês","Filosofia","Noções de Empreendedorismo","EVT","DGD","Educação Física"]
};

function preencherSemanas(id) {
  const sel = document.getElementById(id);
  sel.innerHTML = '';
  for (let i = 1; i <= 13; i++) {
    const opt = document.createElement('option');
    opt.value = i;
    opt.textContent = `${i}ª Semana`;
    sel.appendChild(opt);
  }
}

function atualizarDisciplinas() {
  const c = document.getElementById('classe');
  const d = document.getElementById('disciplina');
  const disc = disciplinasPorClasse[c.value] || [];
  d.innerHTML = '';
  disc.forEach(nome => {
    const opt = document.createElement('option');
    opt.value = nome;
    opt.textContent = nome;
    d.appendChild(opt);
  });
}

window.addEventListener('DOMContentLoaded', () => {
  const c = document.getElementById('classe');
  Object.keys(disciplinasPorClasse).forEach(classe => {
    const opt = document.createElement('option');
    opt.value = classe;
    opt.textContent = classe;
    c.appendChild(opt);
  });
  c.value = "1ª Classe";
  atualizarDisciplinas();
  preencherSemanas('semanaDe');
  preencherSemanas('semanaAte');
});

document.getElementById('classe').addEventListener('change', atualizarDisciplinas);

async function gerarPlano() {
  const c = document.getElementById('classe').value;
  const d = document.getElementById('disciplina').value;
  const t = document.getElementById('trimestre').value;
  const de = parseInt(document.getElementById('semanaDe').value);
  const ate = parseInt(document.getElementById('semanaAte').value);

  if (!c || !d || !t) {
    alert("Selecione Classe, Disciplina e Trimestre.");
    return;
  }
  if (de > ate) {
    alert("Semana inicial não pode ser maior que a final.");
    return;
  }
  if (ate - de > 2) {
    alert("O intervalo não pode exceder 3 semanas (ex: 1 a 3).");
    return;
  }

  try {
    const url = `${API_URL}?classe=${encodeURIComponent(c)}&disciplina=${encodeURIComponent(d)}&trimestre=${encodeURIComponent(t)}&semanaDe=${de}&semanaAte=${ate}`;
    const res = await fetch(url, { mode: "cors" });

    if (!res.ok) throw new Error("Falha na resposta da API");

    const planos = await res.json();

    let txt = "";
    planos.forEach(p => {
      txt += `Semana ${p.numero}\n`;
      txt += `Unidade Temática: ${p.unidade_tematica || ""}\n`;
      txt += `Objetivos: ${p.objetivo_especifico || ""}\n`;
      txt += `Conteúdos: ${p.conteudo || ""}\n`;
      txt += `Competências: ${p.competencia_basica || ""}\n`;
      txt += `Carga Horária: ${p.carga_horaria || ""}\n\n`;
    });

    const el = document.getElementById("planoConteudo");
    el.textContent = txt || "Nenhum plano encontrado.";
    document.getElementById("resultado").style.display = "block";
  } catch (e) {
    console.error("Erro ao gerar plano:", e);
    alert("❌ Erro ao carregar plano. Verifique o link da API.");
  }
}
</script>
</body>
</html>
